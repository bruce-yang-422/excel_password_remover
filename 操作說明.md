# Excel 密碼移除工具 v3.0 操作說明

## 📋 目錄

1. [系統需求](#系統需求)
2. [快速開始](#快速開始)
3. [資料夾結構](#資料夾結構)
4. [使用步驟](#使用步驟)
5. [檔案命名規則](#檔案命名規則)
6. [輸出結果](#輸出結果)
7. [常見問題](#常見問題)
8. [注意事項](#注意事項)

---

## 🖥️ 系統需求

- **作業系統**：Windows 10 或 Windows 11
- **其他需求**：無需安裝 Python 或其他軟體（已內建所有依賴）

---

## 🚀 快速開始

### 步驟 1：解壓縮檔案

將下載的壓縮檔解壓縮到任意目錄，例如：
```
D:\Excel密碼移除工具\
```

### 步驟 2：確認資料夾結構

解壓縮後，您應該看到以下結構：
```
Excel密碼移除工具_v3/
├── Excel密碼移除工具_v3.exe    ← 主程式
├── mapping/
│   └── shops_master.json        ← 店家資料和密碼本（必須存在）
├── input/                       ← 放置要處理的檔案
├── output/                      ← 處理後的檔案（自動建立）
├── log/                         ← 處理日誌（自動建立）
└── temp/                        ← 臨時檔案（自動建立）
```

### 步驟 3：設定 UnRAR.exe（處理 RAR 檔案需要）

如果您需要處理 RAR 壓縮檔案，請設定 UnRAR.exe：

1. **下載 UnRAR for Windows**
   - 官方網站：https://www.rarlab.com/rar_add.htm
   - 選擇 Windows 版本下載（32-bit 或 64-bit）

2. **解壓縮並取得 UnRAR.exe**
   - 解壓縮下載的檔案
   - 找到 `UnRAR.exe` 檔案

3. **放置 UnRAR.exe**
   - 將 `UnRAR.exe` 複製到與 `Excel密碼移除工具_v3.exe` 相同的目錄
   - 或放在 `scripts/` 資料夾中（如果存在）

**注意**：
- 如果只需要處理 ZIP 或 Excel 檔案，可以跳過此步驟
- 程式會自動尋找 UnRAR.exe，如果找不到會提示錯誤

### 步驟 4：放置要處理的檔案

將需要處理的 Excel 檔案或壓縮檔案放入 `input/` 資料夾中。

---

## 📂 資料夾結構

### 必要資料夾

- **`input/`** - 放置需要處理的檔案
  - 可直接放在 `input/` 根目錄
  - 或放在平台分類資料夾中（見下方說明）

- **`mapping/`** - 必須包含 `shops_master.json` 檔案
  - 此檔案包含店家資料和密碼資訊
  - **⚠️ 重要：此檔案必須存在，否則程式無法執行**

- **`UnRAR.exe`** - RAR 解壓縮工具（選用，處理 RAR 檔案需要）
  - 如果不需要處理 RAR 檔案，可以不需要此檔案
  - 應放在與主程式相同的目錄，或 `scripts/` 資料夾中
  - 下載連結：https://www.rarlab.com/rar_add.htm

### 自動建立的資料夾

- **`output/`** - 處理後的檔案會自動放在這裡
- **`log/`** - 每次執行都會生成新的日誌檔案
- **`temp/`** - 臨時檔案目錄（處理完成後會自動清理）

### 平台分類資料夾

您可以在 `input/` 下建立平台分類資料夾，程式會自動識別：

```
input/
├── Shopee_files/         # 蝦皮平台檔案
├── MOMO_files/           # MOMO 平台檔案
├── PChome_files/         # PChome 平台檔案
├── Yahoo_files/          # Yahoo 平台檔案
├── ETMall_files/         # ETMall 平台檔案
├── mo_store_plus_files/  # MO Store Plus 平台檔案
└── coupang_files/        # Coupang 平台檔案
```

**注意**：
- 如果檔案放在平台資料夾中，程式會優先使用該平台的密碼進行破解
- 如果檔案放在 `input/` 根目錄，程式會嘗試所有平台的密碼

---

## 📝 使用步驟

### 基本使用流程

1. **準備檔案**
   - 將需要處理的 Excel 檔案（`.xlsx` 或 `.xls`）放入 `input/` 資料夾
   - 或放入對應的平台資料夾中

2. **執行程式**
   - 雙擊 `Excel密碼移除工具_v3.exe` 執行
   - 程式會自動開始處理

3. **查看結果**
   - 處理完成後，程式會顯示處理統計資訊
   - 處理後的檔案會自動放在 `output/` 資料夾
   - 詳細日誌會保存在 `log/` 資料夾

### 處理壓縮檔案

程式支援處理 ZIP 和 RAR 壓縮檔案：

1. 將壓縮檔案（`.zip` 或 `.rar`）放入 `input/` 資料夾
2. 程式會自動解壓縮並處理其中的 Excel 檔案
3. 解壓縮後的 Excel 檔案會自動進行密碼破解

**注意**：
- RAR 檔案需要密碼時，程式會嘗試使用密碼本中的密碼
- 如果壓縮檔案有密碼但密碼本中沒有，會記錄在日誌中

---

## 🏷️ 檔案命名規則

處理後的檔案會按照以下格式重新命名：

```
{shop_name}_{shop_id}_{shop_account}_{執行日期時間}_{流水號}.xlsx
```

### 命名範例

- `店家名稱A_SH0021_account123_20250116_143052_01.xlsx`
- `店家名稱B_MOSP01_TP0007661_20250116_143052_01.xls`
- `店家名稱C_ETM001_541767_20250116_143052_01.xls`

**注意**：以上為範例，實際檔案名稱會根據店家資訊自動生成

### 命名說明

- **shop_name**：店家名稱
- **shop_id**：店家代碼
- **shop_account**：店家帳號
- **執行日期時間**：處理時間（格式：YYYYMMDD_HHMMSS）
- **流水號**：從 01 開始的序號（避免檔名重複）

---

## 📊 輸出結果

### 成功處理

- ✅ 檔案會自動移除密碼保護
- ✅ 檔案會重新命名並移動到 `output/` 目錄
- ✅ 生成詳細的處理日誌

### 處理失敗

- ❌ 錯誤資訊會記錄在日誌中
- ❌ 原始檔案保持不變（不會被刪除或修改）
- ❌ 可在日誌中查看失敗原因

### 檔案衝突處理

如果 `output/` 目錄中已有相同名稱的檔案：
- 舊檔案會自動備份到 `output/backup/` 目錄
- 新檔案會正常保存
- 備份檔案會加上時間戳記

### 日誌檔案

每次執行都會在 `log/` 目錄生成新的日誌檔案，檔名格式：
```
batch_removal_log_YYYYMMDD_HHMMSS.txt
```

日誌內容包括：
- 處理的檔案列表
- 成功/失敗統計
- 錯誤訊息
- 檔案重新命名對照表

---

## 🔧 支援的檔案格式

### Excel 檔案
- ✅ `.xlsx` - Excel 2007 及以上版本
- ✅ `.xls` - Excel 97-2003 版本

### 壓縮檔案
- ✅ `.zip` - ZIP 壓縮檔案
- ✅ `.rar` - RAR 壓縮檔案（需要密碼本中有對應密碼）

---

## ❓ 常見問題

### Q1：程式無法啟動？

**可能原因：**
- Windows 版本過舊（需要 Windows 10 或以上）
- 防毒軟體阻擋（請將程式加入白名單）
- 檔案損壞（請重新下載）

**解決方法：**
- 檢查 Windows 版本
- 暫時關閉防毒軟體測試
- 以系統管理員身份執行

### Q2：找不到 `shops_master.json` 檔案？

**錯誤訊息：** `找不到 mapping/shops_master.json`

**解決方法：**
- 確認 `mapping/` 資料夾存在
- 確認 `mapping/shops_master.json` 檔案存在
- 確認檔案沒有被重新命名或移動

### Q3：檔案處理失敗？

**可能原因：**
- 密碼本中沒有對應的密碼
- 檔案已損壞
- 檔案格式不支援

**解決方法：**
- 檢查日誌檔案查看詳細錯誤訊息
- 確認密碼本中有該店家的密碼
- 確認檔案格式正確

### Q4：RAR 檔案無法解壓縮？

**錯誤訊息：** `系統未找到可用的 RAR 解壓工具`

**解決方法：**
1. **確認 UnRAR.exe 存在**
   - 檢查與主程式相同目錄中是否有 `UnRAR.exe`
   - 或檢查 `scripts/` 資料夾中是否有 `UnRAR.exe`

2. **下載並放置 UnRAR.exe**
   - 下載 UnRAR for Windows：https://www.rarlab.com/rar_add.htm
   - 解壓縮下載的檔案，找到 `UnRAR.exe`
   - 將 `UnRAR.exe` 複製到與主程式相同的目錄
   - 重新執行程式

3. **其他檢查**
   - 確認 RAR 檔案沒有損壞
   - 檢查日誌檔案查看詳細錯誤訊息

### Q5：處理速度很慢？

**可能原因：**
- 檔案數量很多
- 檔案很大
- 需要嘗試多個密碼

**說明：**
- 這是正常現象，程式需要逐一處理每個檔案
- 可以查看控制台輸出了解處理進度
- 處理完成後會顯示統計資訊

### Q6：如何更新密碼本？

**方法：**
1. 編輯 `mapping/shops_master.json` 檔案（使用文字編輯器）
2. 按照現有格式添加或修改店家資訊
3. 儲存檔案後重新執行程式

**⚠️ 注意：** 修改 JSON 檔案時請注意格式正確，否則程式可能無法讀取。

---

## ⚠️ 注意事項

### 重要提醒

1. **備份原始檔案**
   - 雖然程式不會修改原始檔案，但建議先備份重要檔案
   - 處理後的檔案會放在 `output/` 目錄，原始檔案仍在 `input/` 目錄

2. **密碼本安全**
   - `mapping/shops_master.json` 包含敏感資訊，請妥善保管
   - 不要將此檔案分享給他人
   - 建議定期備份此檔案

3. **檔案命名**
   - 處理後的檔案會自動重新命名
   - 如果原始檔名包含重要資訊，請先記錄
   - 可在日誌檔案中查看原始檔名與新檔名的對照

4. **平台分類**
   - 將檔案放在對應的平台資料夾可以加快處理速度
   - 程式會優先使用該平台的密碼進行破解
   - 如果無法確定平台，可以放在 `input/` 根目錄

5. **批次處理**
   - 程式支援一次處理多個檔案
   - 可以將多個檔案同時放入 `input/` 資料夾
   - 處理完成後會統一輸出到 `output/` 目錄

6. **日誌檢查**
   - 建議每次處理後檢查日誌檔案
   - 日誌檔案包含完整的處理記錄和錯誤資訊
   - 如有問題可根據日誌進行排查

### 使用限制

- 僅支援 Windows 作業系統
- 需要密碼本中有對應店家的密碼才能破解
- 不支援加密的 Excel 檔案（僅支援密碼保護的開啟限制）

---

## 📞 技術支援

如遇到問題，請：

1. 檢查日誌檔案（`log/` 目錄）
2. 確認資料夾結構正確
3. 確認 `mapping/shops_master.json` 檔案存在且格式正確
4. 查看本說明文件的「常見問題」章節

---

## 📝 版本資訊

- **版本**：v3.0.0
- **更新日期**：2025-12-10
- **主要功能**：
  - ✅ 自動破解 Excel 檔案密碼保護
  - ✅ 支援 ZIP/RAR 壓縮檔案處理
  - ✅ 智能檔案重新命名
  - ✅ 平台分類處理
  - ✅ 詳細日誌記錄

---

**祝您使用愉快！** 🎉

