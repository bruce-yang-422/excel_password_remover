# Excel 密碼移除工具 v3.0 操作說明

## 📖 關於本工具

**Excel 密碼移除工具** 是一個自動化工具，可以批次處理受密碼保護的 Excel 檔案。工具會自動：
- 🔓 移除 Excel 檔案的密碼保護
- 📦 解壓縮 ZIP/RAR 壓縮檔案
- 🏷️ 根據店家資訊自動重新命名檔案
- 📊 生成詳細的處理日誌

---

## 🖥️ 系統需求

- **作業系統**：Windows 10 或 Windows 11
- **其他需求**：無需安裝任何額外軟體（所有依賴已內建）

---

## 🚀 快速開始（3 步驟）

### 步驟 1：解壓縮並確認檔案

1. 將下載的壓縮檔解壓縮到任意目錄
2. 確認以下檔案和資料夾存在：

```
Excel密碼移除工具_v3/
├── Excel密碼移除工具_v3.exe    ← 主程式（雙擊執行）
├── mapping/
│   └── shops_master.json        ← 必須存在！
└── input/                       ← 放置要處理的檔案
```

**⚠️ 重要**：`mapping/shops_master.json` 檔案必須存在，否則程式無法執行。

### 步驟 2：放置要處理的檔案

將需要處理的檔案放入 `input/` 資料夾：

- **Excel 檔案**：`.xlsx` 或 `.xls` 格式
- **壓縮檔案**：`.zip` 或 `.rar` 格式（會自動解壓縮）

**可選**：您可以建立平台分類資料夾來加快處理速度：
```
input/
├── Shopee_files/      ← 蝦皮平台檔案
├── MOMO_files/        ← MOMO 平台檔案
├── ETMall_files/      ← 東森購物檔案
└── ...                ← 其他平台資料夾
```

### 步驟 3：執行程式

1. 雙擊 `Excel密碼移除工具_v3.exe`
2. 程式會自動開始處理
3. 處理完成後，查看 `output/` 資料夾中的結果

---

## 📂 資料夾說明

### 必要資料夾

| 資料夾 | 說明 | 備註 |
|--------|------|------|
| `input/` | 放置要處理的檔案 | 必須存在 |
| `mapping/` | 存放密碼本 | 必須包含 `shops_master.json` |

### 自動建立的資料夾

| 資料夾 | 說明 |
|--------|------|
| `output/` | 處理後的檔案會放在這裡 |
| `log/` | 每次執行都會生成新的日誌檔案 |
| `temp/` | 臨時檔案（處理完成後會自動清理） |

---

## 📝 檔案命名規則

處理後的檔案會自動重新命名為：

```
{店家名稱}_{店家代碼}_{店家帳號}_{日期時間}_{流水號}.xlsx
```

### 範例

- `店家名稱A_SH0021_account123_20250116_143052_01.xlsx`
- `店家名稱B_MOSP01_TP0007661_20250116_143052_02.xls`

### 命名說明

- **店家名稱**：來自密碼本中的店家名稱
- **店家代碼**：如 SH0021、MOSP01 等
- **店家帳號**：店家的帳號名稱
- **日期時間**：處理時間（格式：YYYYMMDD_HHMMSS）
- **流水號**：從 01 開始，避免檔名重複

---

## 🔧 支援的檔案格式

### Excel 檔案
- ✅ `.xlsx` - Excel 2007 及以上版本
- ✅ `.xls` - Excel 97-2003 版本

### 壓縮檔案
- ✅ `.zip` - ZIP 壓縮檔案
- ✅ `.rar` - RAR 壓縮檔案（需要 UnRAR.exe，見下方說明）

---

## ⚙️ 進階設定

### 處理 RAR 檔案（選用）

如果您需要處理 RAR 壓縮檔案：

1. **下載 UnRAR.exe**
   - 官方網站：https://www.rarlab.com/rar_add.htm
   - 選擇 Windows 版本下載

2. **放置 UnRAR.exe**
   - 將 `UnRAR.exe` 放在與 `Excel密碼移除工具_v3.exe` 相同的目錄
   - 或放在 `scripts/` 資料夾中（如果存在）

**注意**：如果只需要處理 ZIP 或 Excel 檔案，可以跳過此步驟。

---

## 📊 處理結果

### 成功處理

- ✅ 檔案會自動移除密碼保護
- ✅ 檔案會重新命名並放在 `output/` 資料夾
- ✅ 生成詳細的處理日誌

### 處理失敗

- ❌ 錯誤資訊會記錄在日誌中
- ❌ 原始檔案保持不變（不會被刪除或修改）

### 檔案衝突

如果 `output/` 中已有相同名稱的檔案：
- 舊檔案會自動備份到 `output/backup/` 目錄
- 新檔案會正常保存

### 查看日誌

每次執行後，在 `log/` 資料夾中會生成日誌檔案，檔名格式：
```
batch_removal_log_YYYYMMDD_HHMMSS.txt
```

日誌包含：
- 處理的檔案列表
- 成功/失敗統計
- 錯誤訊息
- 檔案重新命名對照表

---

## ❓ 常見問題

### Q1：程式無法啟動？

**可能原因：**
- Windows 版本過舊（需要 Windows 10 或以上）
- 防毒軟體阻擋

**解決方法：**
- 檢查 Windows 版本
- 將程式加入防毒軟體白名單
- 以系統管理員身份執行

### Q2：找不到 `shops_master.json`？

**錯誤訊息：** `找不到 mapping/shops_master.json`

**解決方法：**
- 確認 `mapping/` 資料夾存在
- 確認 `mapping/shops_master.json` 檔案存在
- 確認檔案沒有被重新命名

### Q3：檔案處理失敗？

**可能原因：**
- 密碼本中沒有對應的密碼
- 檔案已損壞
- 檔案格式不支援

**解決方法：**
- 檢查日誌檔案查看詳細錯誤
- 確認密碼本中有該店家的密碼
- 確認檔案格式正確

### Q4：RAR 檔案無法解壓縮？

**錯誤訊息：** `系統未找到可用的 RAR 解壓工具`

**解決方法：**
1. 確認 `UnRAR.exe` 存在於程式目錄
2. 下載 UnRAR：https://www.rarlab.com/rar_add.htm
3. 將 `UnRAR.exe` 放在與主程式相同的目錄
4. 重新執行程式

### Q5：處理速度很慢？

**說明：**
- 這是正常現象，程式需要逐一處理每個檔案
- 可以查看控制台輸出了解處理進度
- 處理完成後會顯示統計資訊

### Q6：如何更新密碼本？

**方法：**
1. 編輯 `mapping/shops_master.json` 檔案（使用文字編輯器）
2. 按照現有格式添加或修改店家資訊
3. 儲存檔案後重新執行程式

**⚠️ 注意：** 修改 JSON 檔案時請注意格式正確，否則程式可能無法讀取。

---

## ⚠️ 重要提醒

### 1. 備份原始檔案
雖然程式不會修改原始檔案，但建議先備份重要檔案。

### 2. 密碼本安全
- `mapping/shops_master.json` 包含敏感資訊，請妥善保管
- 不要將此檔案分享給他人
- 建議定期備份此檔案

### 3. 檔案命名
- 處理後的檔案會自動重新命名
- 如果原始檔名包含重要資訊，請先記錄
- 可在日誌檔案中查看原始檔名與新檔名的對照

### 4. 平台分類
- 將檔案放在對應的平台資料夾可以加快處理速度
- 程式會優先使用該平台的密碼進行破解
- 如果無法確定平台，可以放在 `input/` 根目錄

---

## 📞 技術支援

如遇到問題，請：

1. 檢查日誌檔案（`log/` 目錄）
2. 確認資料夾結構正確
3. 確認 `mapping/shops_master.json` 檔案存在且格式正確
4. 查看本說明文件的「常見問題」章節

---

## 📝 版本資訊

- **版本**：v3.0.0
- **更新日期**：2025-12-10
- **主要功能**：
  - ✅ 自動破解 Excel 檔案密碼保護
  - ✅ 支援 ZIP/RAR 壓縮檔案處理
  - ✅ 智能檔案重新命名
  - ✅ 平台分類處理
  - ✅ 詳細日誌記錄

---

**祝您使用愉快！** 🎉
